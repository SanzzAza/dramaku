<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>DramaCin - Nonton Drama China</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --primary: #F5A623;
    --primary-dark: #E8961A;
    --primary-light: #FFF3DC;
    --bg: #F7F8FA;
    --card: #FFFFFF;
    --text: #1A1A2E;
    --text-muted: #8A8FAB;
    --border: #ECEEF5;
    --nav-h: 68px;
    --top-h: 56px;
    --radius: 16px;
    --shadow: 0 4px 20px rgba(0,0,0,0.08);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

  body {
    font-family: 'Nunito', sans-serif;
    background: var(--bg);
    color: var(--text);
    height: 100vh;
    overflow: hidden;
    position: relative;
  }

  /* SCREENS */
  .screen { 
    position: absolute; inset: 0;
    display: none; flex-direction: column;
    opacity: 0; transition: opacity 0.25s ease;
  }
  .screen.active { display: flex; opacity: 1; }

  /* SCROLLABLE CONTENT */
  .scroll-area {
    flex: 1;
    overflow-y: auto;
    padding-bottom: calc(var(--nav-h) + 8px);
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }
  .scroll-area::-webkit-scrollbar { display: none; }

  /* TOP BAR */
  .topbar {
    height: var(--top-h);
    background: var(--card);
    display: flex; align-items: center;
    padding: 0 16px;
    gap: 12px;
    border-bottom: 1px solid var(--border);
    position: sticky; top: 0; z-index: 10;
    flex-shrink: 0;
  }
  .topbar-logo {
    font-family: 'Poppins', sans-serif;
    font-weight: 800; font-size: 20px;
    color: var(--primary);
    letter-spacing: -0.5px;
  }
  .topbar-logo span { color: var(--text); }
  .topbar-right { margin-left: auto; display: flex; gap: 10px; }
  .icon-btn {
    width: 36px; height: 36px;
    background: var(--bg); border-radius: 50%;
    border: none; display: flex; align-items: center; justify-content: center;
    cursor: pointer; font-size: 18px;
  }

  /* BOTTOM NAV */
  .bottom-nav {
    position: fixed; bottom: 0; left: 0; right: 0;
    height: var(--nav-h);
    background: var(--card);
    border-top: 1px solid var(--border);
    display: flex; z-index: 100;
    padding-bottom: env(safe-area-inset-bottom);
    box-shadow: 0 -4px 20px rgba(0,0,0,0.06);
  }
  .nav-item {
    flex: 1; display: flex; flex-direction: column;
    align-items: center; justify-content: center; gap: 3px;
    border: none; background: none; cursor: pointer;
    font-family: 'Nunito', sans-serif;
    font-size: 11px; font-weight: 700;
    color: var(--text-muted);
    transition: color 0.2s;
  }
  .nav-item .nav-icon { font-size: 22px; transition: transform 0.2s; }
  .nav-item.active { color: var(--primary); }
  .nav-item.active .nav-icon { transform: scale(1.15); }

  /* HERO BANNER */
  .hero {
    margin: 12px;
    border-radius: var(--radius);
    overflow: hidden;
    position: relative;
    height: 200px;
    background: linear-gradient(135deg, #1a1a2e, #16213e);
    flex-shrink: 0;
  }
  .hero-img {
    width: 100%; height: 100%;
    object-fit: cover; opacity: 0.7;
  }
  .hero-overlay {
    position: absolute; inset: 0;
    background: linear-gradient(to top, rgba(0,0,0,0.85) 0%, transparent 60%);
  }
  .hero-content {
    position: absolute; bottom: 0; left: 0; right: 0;
    padding: 14px;
  }
  .hero-badge {
    display: inline-flex; align-items: center; gap: 4px;
    background: var(--primary); color: white;
    font-size: 10px; font-weight: 800;
    padding: 3px 8px; border-radius: 20px;
    margin-bottom: 6px; text-transform: uppercase; letter-spacing: 0.5px;
  }
  .hero-title {
    font-size: 17px; font-weight: 900; color: white;
    line-height: 1.2; margin-bottom: 8px;
  }
  .hero-meta { display: flex; align-items: center; gap: 8px; }
  .hero-meta span { font-size: 11px; color: rgba(255,255,255,0.75); font-weight: 600; }
  .hero-btn {
    background: var(--primary); color: white;
    border: none; border-radius: 20px;
    padding: 7px 16px; font-size: 12px; font-weight: 800;
    font-family: 'Nunito', sans-serif;
    cursor: pointer; display: flex; align-items: center; gap: 5px;
    margin-left: auto;
  }
  .hero-dots {
    position: absolute; bottom: 50px; left: 50%; transform: translateX(-50%);
    display: flex; gap: 5px;
  }
  .hero-dot {
    width: 20px; height: 3px; border-radius: 2px;
    background: rgba(255,255,255,0.3);
    transition: all 0.3s;
  }
  .hero-dot.active { background: var(--primary); width: 28px; }

  /* SECTION */
  .section { padding: 16px 16px 0; }
  .section-header {
    display: flex; align-items: center; justify-content: space-between;
    margin-bottom: 14px;
  }
  .section-title {
    font-size: 16px; font-weight: 900;
    display: flex; align-items: center; gap: 6px;
  }
  .see-all {
    font-size: 13px; font-weight: 700;
    color: var(--primary); border: none; background: none;
    cursor: pointer; font-family: 'Nunito', sans-serif;
  }

  /* HORIZONTAL SCROLL */
  .h-scroll {
    display: flex; gap: 12px;
    overflow-x: auto; padding-bottom: 4px;
    scrollbar-width: none;
  }
  .h-scroll::-webkit-scrollbar { display: none; }

  /* DRAMA CARD (vertical) */
  .drama-card {
    flex-shrink: 0; width: 120px; cursor: pointer;
  }
  .drama-card-img {
    width: 120px; height: 170px;
    border-radius: 12px;
    object-fit: cover; background: #ddd;
    position: relative; overflow: hidden;
    display: block;
  }
  .drama-card-img .ep-badge {
    position: absolute; bottom: 6px; left: 6px;
    background: rgba(0,0,0,0.7);
    color: white; font-size: 10px; font-weight: 700;
    padding: 2px 6px; border-radius: 6px;
  }
  .drama-card-img .cover-placeholder {
    width: 100%; height: 100%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    color: white; font-size: 11px; font-weight: 700;
    text-align: center; padding: 8px;
  }
  .drama-card-title {
    font-size: 12px; font-weight: 700;
    margin-top: 7px; line-height: 1.3;
    display: -webkit-box; -webkit-line-clamp: 2;
    -webkit-box-orient: vertical; overflow: hidden;
  }
  .drama-card-star {
    font-size: 11px; color: var(--text-muted);
    margin-top: 2px; font-weight: 600;
  }

  /* RANK CARD (horizontal) */
  .rank-list { display: flex; flex-direction: column; gap: 10px; padding: 0 16px; }
  .rank-card {
    background: var(--card);
    border-radius: 14px;
    padding: 12px;
    display: flex; align-items: center; gap: 12px;
    cursor: pointer;
    box-shadow: var(--shadow);
  }
  .rank-num {
    font-size: 24px; font-weight: 900;
    font-family: 'Poppins', sans-serif;
    min-width: 32px; text-align: center;
  }
  .rank-num.gold { color: #FFD700; }
  .rank-num.silver { color: #C0C0C0; }
  .rank-num.bronze { color: #CD7F32; }
  .rank-num.normal { color: var(--text-muted); }
  .rank-cover {
    width: 52px; height: 70px;
    border-radius: 10px; object-fit: cover;
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    flex-shrink: 0;
  }
  .rank-info { flex: 1; min-width: 0; }
  .rank-title {
    font-size: 13px; font-weight: 800;
    white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }
  .rank-meta { font-size: 11px; color: var(--text-muted); margin-top: 3px; font-weight: 600; }
  .rank-score {
    font-size: 13px; font-weight: 800; color: var(--primary);
    display: flex; align-items: center; gap: 2px;
  }

  /* SEARCH */
  .search-box {
    margin: 12px;
    background: var(--card);
    border-radius: 14px;
    padding: 12px 16px;
    display: flex; align-items: center; gap: 10px;
    border: 2px solid var(--border);
    transition: border-color 0.2s;
  }
  .search-box:focus-within { border-color: var(--primary); }
  .search-box input {
    flex: 1; border: none; background: none;
    font-family: 'Nunito', sans-serif;
    font-size: 14px; color: var(--text);
    outline: none;
  }
  .search-box input::placeholder { color: var(--text-muted); }
  .search-btn {
    border: none; background: var(--primary);
    color: white; border-radius: 10px;
    padding: 7px 14px; font-size: 13px; font-weight: 800;
    font-family: 'Nunito', sans-serif; cursor: pointer;
  }

  /* TAGS */
  .tag-list { display: flex; flex-wrap: wrap; gap: 8px; padding: 0 16px; margin-bottom: 16px; }
  .tag {
    background: var(--primary-light); color: var(--primary-dark);
    border: none; border-radius: 20px;
    padding: 6px 14px; font-size: 13px; font-weight: 700;
    font-family: 'Nunito', sans-serif; cursor: pointer;
    transition: all 0.2s;
  }
  .tag:active { background: var(--primary); color: white; }

  /* GRID 2 COL */
  .grid-2 {
    display: grid; grid-template-columns: 1fr 1fr;
    gap: 12px; padding: 0 16px;
  }
  .grid-card { cursor: pointer; }
  .grid-card-img {
    width: 100%; aspect-ratio: 3/4;
    border-radius: 14px; object-fit: cover;
    background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    position: relative; overflow: hidden;
  }
  .grid-rank-badge {
    position: absolute; top: 8px; left: 8px;
    background: var(--primary); color: white;
    font-size: 11px; font-weight: 900;
    padding: 3px 8px; border-radius: 20px;
    font-family: 'Poppins', sans-serif;
  }
  .grid-card-title {
    font-size: 13px; font-weight: 800;
    margin-top: 8px; line-height: 1.3;
    display: -webkit-box; -webkit-line-clamp: 2;
    -webkit-box-orient: vertical; overflow: hidden;
  }

  /* DETAIL SCREEN */
  .detail-header {
    position: relative; height: 280px;
    background: #1a1a2e; flex-shrink: 0;
  }
  .detail-cover {
    width: 100%; height: 100%; object-fit: cover; opacity: 0.5;
  }
  .detail-overlay {
    position: absolute; inset: 0;
    background: linear-gradient(to top, #F7F8FA 0%, transparent 50%);
  }
  .back-btn {
    position: absolute; top: 12px; left: 12px;
    background: rgba(0,0,0,0.4); border: none;
    color: white; width: 36px; height: 36px; border-radius: 50%;
    font-size: 18px; cursor: pointer;
    display: flex; align-items: center; justify-content: center;
  }
  .detail-thumb {
    position: absolute; bottom: -50px; left: 16px;
    width: 100px; height: 140px;
    border-radius: 14px; object-fit: cover;
    box-shadow: 0 8px 24px rgba(0,0,0,0.25);
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: 3px solid white;
  }
  .detail-info { padding: 60px 16px 20px; }
  .detail-title { font-size: 20px; font-weight: 900; line-height: 1.2; }
  .detail-meta {
    display: flex; gap: 12px; margin-top: 10px; flex-wrap: wrap;
  }
  .detail-badge {
    background: var(--primary-light); color: var(--primary-dark);
    font-size: 11px; font-weight: 700;
    padding: 4px 10px; border-radius: 20px;
  }
  .detail-desc {
    font-size: 13px; color: var(--text-muted); line-height: 1.6;
    margin-top: 12px; font-weight: 600;
  }
  .detail-desc.collapsed { 
    display: -webkit-box; -webkit-line-clamp: 3;
    -webkit-box-orient: vertical; overflow: hidden;
  }
  .detail-read-more {
    background: none; border: none; color: var(--primary);
    font-size: 12px; font-weight: 700; cursor: pointer;
    font-family: 'Nunito', sans-serif; margin-top: 4px;
  }
  .detail-action {
    display: flex; gap: 10px; margin-top: 16px;
  }
  .btn-primary {
    flex: 1; background: var(--primary); color: white;
    border: none; border-radius: 14px;
    padding: 14px; font-size: 14px; font-weight: 800;
    font-family: 'Nunito', sans-serif; cursor: pointer;
    display: flex; align-items: center; justify-content: center; gap: 6px;
  }
  .btn-secondary {
    background: var(--bg); color: var(--text);
    border: 2px solid var(--border); border-radius: 14px;
    padding: 14px 18px; font-size: 20px;
    cursor: pointer; display: flex; align-items: center;
  }

  /* EPISODES */
  .ep-section { padding: 0 16px 16px; }
  .ep-title { font-size: 15px; font-weight: 900; margin-bottom: 12px; }
  .ep-grid {
    display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px;
  }
  .ep-btn {
    background: var(--card); border: 2px solid var(--border);
    border-radius: 10px; padding: 10px 4px;
    font-size: 12px; font-weight: 800;
    font-family: 'Nunito', sans-serif; cursor: pointer;
    text-align: center; color: var(--text); transition: all 0.2s;
  }
  .ep-btn:active, .ep-btn.active {
    background: var(--primary); border-color: var(--primary);
    color: white;
  }
  .ep-btn.locked { color: var(--text-muted); }
  .ep-btn.locked::after { content: "üîí"; display: block; font-size: 10px; }

  /* WATCH SCREEN */
  .video-player {
    width: 100%; aspect-ratio: 16/9;
    background: #000;
    display: flex; align-items: center; justify-content: center;
    flex-direction: column; gap: 12px;
    flex-shrink: 0;
  }
  .video-placeholder { color: rgba(255,255,255,0.6); font-size: 13px; font-weight: 600; text-align: center; padding: 16px; }
  .play-big { font-size: 56px; }
  .watch-link-btn {
    background: var(--primary); color: white;
    border: none; border-radius: 12px;
    padding: 12px 24px; font-size: 14px; font-weight: 800;
    font-family: 'Nunito', sans-serif; cursor: pointer;
    text-decoration: none; display: inline-flex;
    align-items: center; gap: 6px;
  }
  .watch-info { padding: 16px; }
  .watch-title { font-size: 16px; font-weight: 900; }
  .watch-sub { font-size: 13px; color: var(--text-muted); margin-top: 4px; font-weight: 600; }
  .watch-nav {
    display: flex; gap: 10px; padding: 0 16px 16px;
  }
  .watch-nav-btn {
    flex: 1; border: 2px solid var(--border);
    background: var(--card); border-radius: 12px;
    padding: 12px; font-size: 13px; font-weight: 800;
    font-family: 'Nunito', sans-serif; cursor: pointer;
    color: var(--text); display: flex; align-items: center;
    justify-content: center; gap: 6px;
  }
  .watch-nav-btn.primary-btn {
    background: var(--primary); border-color: var(--primary); color: white;
  }

  /* LOADING */
  .loader {
    display: flex; flex-direction: column;
    align-items: center; justify-content: center;
    gap: 12px; padding: 40px;
  }
  .spinner {
    width: 36px; height: 36px;
    border: 3px solid var(--border);
    border-top-color: var(--primary);
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* EMPTY */
  .empty {
    text-align: center; padding: 48px 24px;
    color: var(--text-muted);
  }
  .empty-icon { font-size: 48px; margin-bottom: 12px; }
  .empty-text { font-size: 15px; font-weight: 700; }
  .empty-sub { font-size: 13px; margin-top: 6px; }

  /* CATEGORY CHIPS */
  .cat-chips { display: flex; gap: 8px; padding: 0 16px; overflow-x: auto; padding-bottom: 4px; scrollbar-width: none; }
  .cat-chips::-webkit-scrollbar { display: none; }
  .cat-chip {
    flex-shrink: 0;
    background: var(--card); border: 2px solid var(--border);
    border-radius: 20px; padding: 8px 16px;
    font-size: 13px; font-weight: 700;
    font-family: 'Nunito', sans-serif; cursor: pointer;
    color: var(--text); transition: all 0.2s;
    white-space: nowrap;
  }
  .cat-chip.active {
    background: var(--primary); border-color: var(--primary); color: white;
  }

  /* PROFILE */
  .profile-header {
    background: linear-gradient(135deg, var(--primary) 0%, #FF6B35 100%);
    padding: 32px 20px 24px; color: white;
    flex-shrink: 0;
  }
  .profile-avatar {
    width: 72px; height: 72px;
    border-radius: 50%; background: rgba(255,255,255,0.3);
    display: flex; align-items: center; justify-content: center;
    font-size: 32px; margin-bottom: 12px;
    border: 3px solid rgba(255,255,255,0.5);
  }
  .profile-name { font-size: 20px; font-weight: 900; }
  .profile-tag { font-size: 13px; opacity: 0.85; font-weight: 600; margin-top: 3px; }
  .profile-menu { padding: 16px; display: flex; flex-direction: column; gap: 2px; }
  .profile-item {
    background: var(--card); border: none;
    padding: 16px; border-radius: 14px;
    display: flex; align-items: center; gap: 14px;
    cursor: pointer; font-family: 'Nunito', sans-serif;
    margin-bottom: 2px;
  }
  .profile-item-icon { font-size: 22px; min-width: 32px; text-align: center; }
  .profile-item-text { flex: 1; text-align: left; }
  .profile-item-label { font-size: 14px; font-weight: 800; color: var(--text); }
  .profile-item-sub { font-size: 12px; color: var(--text-muted); font-weight: 600; margin-top: 1px; }

  /* VIP CARD */
  .vip-banner {
    margin: 12px; border-radius: var(--radius);
    background: linear-gradient(135deg, #F5A623 0%, #FF6B35 100%);
    padding: 20px; color: white;
    position: relative; overflow: hidden;
  }
  .vip-banner::before {
    content: 'üëë';
    position: absolute; right: -10px; top: -10px;
    font-size: 80px; opacity: 0.15;
  }
  .vip-banner-title { font-size: 20px; font-weight: 900; }
  .vip-banner-sub { font-size: 13px; opacity: 0.9; margin-top: 4px; font-weight: 600; }
  .vip-banner-btn {
    margin-top: 14px; background: white; color: var(--primary-dark);
    border: none; border-radius: 10px; padding: 10px 20px;
    font-size: 13px; font-weight: 900; font-family: 'Nunito', sans-serif; cursor: pointer;
  }

  /* TOAST */
  .toast {
    position: fixed; top: 70px; left: 50%; transform: translateX(-50%);
    background: rgba(26,26,46,0.9); color: white;
    padding: 10px 20px; border-radius: 20px;
    font-size: 13px; font-weight: 700;
    z-index: 999; opacity: 0; pointer-events: none;
    transition: opacity 0.3s; white-space: nowrap;
  }
  .toast.show { opacity: 1; }
</style>
</head>
<body>

<!-- SCREENS -->

<!-- HOME -->
<div class="screen active" id="screen-home">
  <div class="topbar">
    <div class="topbar-logo">Drama<span>Cin</span></div>
    <div class="topbar-right">
      <button class="icon-btn" onclick="showToast('Notifikasi')">üîî</button>
    </div>
  </div>
  <div class="scroll-area" id="home-scroll">
    <!-- Hero Banner -->
    <div id="hero-container">
      <div class="hero">
        <div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#1a1a2e,#16213e)">
          <div style="text-align:center;color:white;opacity:0.4;font-size:40px">üé¨</div>
        </div>
        <div class="hero-overlay"></div>
        <div class="hero-content">
          <div style="display:flex;align-items:flex-end;justify-content:space-between">
            <div>
              <div class="hero-badge">üî• Trending</div>
              <div class="hero-title" id="hero-title">Memuat...</div>
              <div class="hero-meta">
                <span id="hero-ep">-- Ep</span>
                <span id="hero-genre">Drama China</span>
              </div>
            </div>
            <button class="hero-btn" id="hero-watch-btn">‚ñ∂ Tonton</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Lagi Populer -->
    <div class="section">
      <div class="section-header">
        <div class="section-title">üî• Lagi Populer</div>
        <button class="see-all" onclick="switchToRank()">Lihat Semua ‚Ä∫</button>
      </div>
      <div class="h-scroll" id="popular-list">
        <div class="loader"><div class="spinner"></div></div>
      </div>
    </div>

    <!-- Terbaru -->
    <div class="section" style="margin-top:8px">
      <div class="section-header">
        <div class="section-title">üì∫ Episode Terbaru</div>
        <button class="see-all" onclick="loadNewDramas()">Lihat Semua ‚Ä∫</button>
      </div>
      <div class="h-scroll" id="new-list">
        <div class="loader"><div class="spinner"></div></div>
      </div>
    </div>

    <div style="height:16px"></div>
  </div>
</div>

<!-- PENCARIAN -->
<div class="screen" id="screen-search">
  <div class="topbar">
    <div class="topbar-logo">Drama<span>Cin</span></div>
  </div>
  <div class="scroll-area">
    <div class="search-box">
      <span style="font-size:18px">üîç</span>
      <input type="text" id="search-input" placeholder="Cari drama, genre..." 
        onkeydown="if(event.key==='Enter') doSearch()">
      <button class="search-btn" onclick="doSearch()">Cari</button>
    </div>

    <div id="search-tags-section">
      <div class="section" style="padding-top:4px">
        <div class="section-header">
          <div class="section-title">üìà Populer Dicari</div>
        </div>
      </div>
      <div class="tag-list" id="suggest-tags">
        <span class="tag" onclick="searchKeyword('cinta')">cinta</span>
        <span class="tag" onclick="searchKeyword('keluarga')">keluarga</span>
        <span class="tag" onclick="searchKeyword('balas dendam')">balas dendam</span>
        <span class="tag" onclick="searchKeyword('pewaris')">pewaris</span>
        <span class="tag" onclick="searchKeyword('istri')">istri</span>
        <span class="tag" onclick="searchKeyword('raja')">raja</span>
      </div>

      <div class="section" style="padding-top:4px">
        <div class="section-header">
          <div class="section-title">üî• Sedang Banyak Dicari</div>
        </div>
      </div>
      <div class="grid-2" id="trending-grid">
        <div class="loader" style="grid-column:span 2"><div class="spinner"></div></div>
      </div>
    </div>

    <div id="search-results-section" style="display:none">
      <div class="section">
        <div class="section-header">
          <div class="section-title" id="search-result-title">Hasil Pencarian</div>
          <button class="see-all" onclick="clearSearch()">‚úï Tutup</button>
        </div>
      </div>
      <div class="rank-list" id="search-results"></div>
    </div>
  </div>
</div>

<!-- RANK -->
<div class="screen" id="screen-rank">
  <div class="topbar">
    <div class="topbar-logo">Drama<span>Cin</span></div>
  </div>
  <div class="scroll-area">
    <div class="section">
      <div class="section-header">
        <div class="section-title">üèÜ Ranking Drama</div>
      </div>
    </div>
    <div class="rank-list" id="rank-list">
      <div class="loader"><div class="spinner"></div></div>
    </div>
    <div style="height:16px"></div>
  </div>
</div>

<!-- DETAIL -->
<div class="screen" id="screen-detail">
  <div class="scroll-area">
    <div class="detail-header">
      <img id="detail-cover" class="detail-cover" src="" alt="">
      <div class="detail-overlay"></div>
      <button class="back-btn" onclick="goBack()">‚Üê</button>
      <img id="detail-thumb" class="detail-thumb" src="" alt="">
    </div>
    <div class="detail-info">
      <div id="detail-title" class="detail-title">Loading...</div>
      <div class="detail-meta" id="detail-meta"></div>
      <div id="detail-desc" class="detail-desc collapsed">-</div>
      <button class="detail-read-more" id="read-more-btn" onclick="toggleDesc()">Selengkapnya ‚Ä∫</button>
      <div class="detail-action">
        <button class="btn-primary" id="detail-watch-btn">‚ñ∂ Mulai Tonton</button>
        <button class="btn-secondary" id="detail-fav-btn" onclick="toggleFav()">ü§ç</button>
      </div>
    </div>
    <div class="ep-section">
      <div class="ep-title">üìã Daftar Episode</div>
      <div class="ep-grid" id="ep-grid">
        <div class="loader" style="grid-column:span 5"><div class="spinner"></div></div>
      </div>
    </div>
    <div style="height:80px"></div>
  </div>
</div>

<!-- WATCH -->
<div class="screen" id="screen-watch">
  <div class="topbar">
    <button class="icon-btn" onclick="goBack()" style="background:none">‚Üê</button>
    <div style="flex:1;font-size:14px;font-weight:800" id="watch-topbar-title">Episode</div>
  </div>
  <div class="scroll-area">
    <div class="video-player" id="video-player">
      <div class="play-big">üé¨</div>
      <div class="video-placeholder" id="video-placeholder">Memuat video...</div>
      <a id="watch-ext-link" class="watch-link-btn" href="#" target="_blank" style="display:none">
        üîó Buka & Tonton
      </a>
    </div>
    <div class="watch-info">
      <div id="watch-title" class="watch-title">Loading...</div>
      <div id="watch-sub" class="watch-sub">Episode --</div>
    </div>
    <div class="watch-nav">
      <button class="watch-nav-btn" id="prev-ep-btn" onclick="changeEp(-1)">‚¨Ö Sebelumnya</button>
      <button class="watch-nav-btn primary-btn" id="next-ep-btn" onclick="changeEp(1)">Berikutnya ‚û°</button>
    </div>
    <div class="ep-section">
      <div class="ep-title">üìã Episode Lain</div>
      <div class="ep-grid" id="watch-ep-grid"></div>
    </div>
    <div style="height:80px"></div>
  </div>
</div>

<!-- PROFIL -->
<div class="screen" id="screen-profile">
  <div class="scroll-area">
    <div class="profile-header">
      <div class="profile-avatar">üë§</div>
      <div class="profile-name" id="profile-name">Pengguna</div>
      <div class="profile-tag" id="profile-tag">Member Gratis</div>
    </div>
    <div class="vip-banner" style="margin:16px">
      <div class="vip-banner-title">üëë Upgrade ke VIP</div>
      <div class="vip-banner-sub">Bebas iklan & akses semua episode HD</div>
      <button class="vip-banner-btn">Mulai dari Rp 2.000/hari</button>
    </div>
    <div class="profile-menu">
      <button class="profile-item" onclick="showToast('Favorit kamu')">
        <span class="profile-item-icon">‚ù§Ô∏è</span>
        <div class="profile-item-text">
          <div class="profile-item-label">Favorit Saya</div>
          <div class="profile-item-sub" id="fav-count-label">0 drama difavoritkan</div>
        </div>
        <span>‚Ä∫</span>
      </button>
      <button class="profile-item" onclick="showToast('Program Afiliasi')">
        <span class="profile-item-icon">ü§ù</span>
        <div class="profile-item-text">
          <div class="profile-item-label">Program Afiliasi</div>
          <div class="profile-item-sub">Dapatkan komisi</div>
        </div>
        <span>‚Ä∫</span>
      </button>
      <button class="profile-item" onclick="showToast('Riwayat Tonton')">
        <span class="profile-item-icon">üì∫</span>
        <div class="profile-item-text">
          <div class="profile-item-label">Riwayat Tonton</div>
          <div class="profile-item-sub" id="history-count-label">0 drama ditonton</div>
        </div>
        <span>‚Ä∫</span>
      </button>
      <button class="profile-item" onclick="showToast('Pengaturan')">
        <span class="profile-item-icon">‚öôÔ∏è</span>
        <div class="profile-item-text">
          <div class="profile-item-label">Pengaturan</div>
          <div class="profile-item-sub">Akun & notifikasi</div>
        </div>
        <span>‚Ä∫</span>
      </button>
      <button class="profile-item" onclick="showToast('Hubungi Admin')">
        <span class="profile-item-icon">üí¨</span>
        <div class="profile-item-text">
          <div class="profile-item-label">Hubungi Admin</div>
          <div class="profile-item-sub">Bantuan & dukungan</div>
        </div>
        <span>‚Ä∫</span>
      </button>
    </div>
    <div style="text-align:center;color:var(--text-muted);font-size:12px;padding:8px;font-weight:600">DramaCin v1.0.0</div>
    <div style="height:80px"></div>
  </div>
</div>

<!-- BOTTOM NAV -->
<nav class="bottom-nav">
  <button class="nav-item active" id="nav-home" onclick="switchScreen('home')">
    <span class="nav-icon">üè†</span>Home
  </button>
  <button class="nav-item" id="nav-search" onclick="switchScreen('search')">
    <span class="nav-icon">üîç</span>Pencarian
  </button>
  <button class="nav-item" id="nav-rank" onclick="switchScreen('rank')">
    <span class="nav-icon">üèÜ</span>Ranking
  </button>
  <button class="nav-item" id="nav-profile" onclick="switchScreen('profile')">
    <span class="nav-icon">üë§</span>Profil
  </button>
</nav>

<!-- TOAST -->
<div class="toast" id="toast"></div>

<script>
// ============================================================
// CONFIG
// ============================================================
const API_BASE = 'https://captain.sapimu.au/dramabox/api/v1';
const API_TOKEN = '53d25de32c37b0fcd2b14a9f834050493cc044d5039b5aff3283da73a8ef761b';
const LANG = 'in';

// ============================================================
// STATE
// ============================================================
let currentScreen = 'home';
let screenHistory = [];
let currentBookId = null;
let currentEp = 1;
let currentMaxEp = 1;
let allChapters = [];
let favorites = JSON.parse(localStorage.getItem('favs') || '[]');
let watchHistory = JSON.parse(localStorage.getItem('history') || '[]');
let homeLoaded = false;
let rankLoaded = false;
let trendingLoaded = false;

// ============================================================
// TELEGRAM WEB APP
// ============================================================
const tg = window.Telegram?.WebApp;
if (tg) {
  tg.ready();
  tg.expand();
  if (tg.initDataUnsafe?.user) {
    const user = tg.initDataUnsafe.user;
    document.getElementById('profile-name').textContent = user.first_name + (user.last_name ? ' ' + user.last_name : '');
    document.getElementById('profile-tag').textContent = '@' + (user.username || 'member');
  }
}

// ============================================================
// API
// ============================================================
async function apiGet(endpoint) {
  try {
    const res = await fetch(`${API_BASE}/${endpoint}`, {
      headers: { 'Authorization': `Bearer ${API_TOKEN}` }
    });
    if (!res.ok) return null;
    const json = await res.json();
    return json;
  } catch(e) {
    console.error('API Error:', e);
    return null;
  }
}

function safeGet(obj, ...keys) {
  for (const key of keys) {
    if (obj == null) return null;
    obj = obj[key];
  }
  return obj ?? null;
}

function getDramas(data) {
  return safeGet(data, 'data', 'list') 
    || safeGet(data, 'data', 'chapterList')
    || (Array.isArray(safeGet(data, 'data')) ? safeGet(data, 'data') : null)
    || [];
}

function getDramaField(d, ...fields) {
  for (const f of fields) {
    const v = d[f];
    if (v) return v;
  }
  return '';
}

// ============================================================
// SCREEN NAVIGATION
// ============================================================
function switchScreen(name, pushHistory = true) {
  if (currentScreen === name) return;
  
  // hide old
  const old = document.getElementById('screen-' + currentScreen);
  if (old) old.classList.remove('active');
  
  // update nav
  ['home','search','rank','profile'].forEach(n => {
    const nav = document.getElementById('nav-' + n);
    if (nav) nav.classList.toggle('active', n === name);
  });

  if (pushHistory && !['detail','watch'].includes(currentScreen)) {
    screenHistory = [currentScreen];
  }
  
  currentScreen = name;
  const next = document.getElementById('screen-' + name);
  if (next) next.classList.add('active');

  // lazy load
  if (name === 'home' && !homeLoaded) loadHome();
  if (name === 'rank' && !rankLoaded) loadRank();
  if (name === 'search' && !trendingLoaded) loadTrending();
}

function goBack() {
  const prev = screenHistory.pop();
  if (prev) {
    switchScreen(prev, false);
  } else {
    switchScreen('home', false);
  }
}

function switchToRank() {
  switchScreen('rank');
}

// ============================================================
// COVER IMAGE
// ============================================================
function makeCoverDiv(drama, cls = 'drama-card-img') {
  const cover = getDramaField(drama, 'coverUrl', 'cover', 'coverImg', 'image', 'pic');
  const title = getDramaField(drama, 'bookName', 'name', 'title');
  const ep = getDramaField(drama, 'chapterCount', 'episodeCount', 'totalChapter');
  
  if (cover) {
    return `<div class="${cls}" style="position:relative">
      <img src="${cover}" style="width:100%;height:100%;object-fit:cover;border-radius:inherit" 
        onerror="this.parentNode.innerHTML='<div class=cover-placeholder style=height:100%>üé¨<br>${title}</div>'"
        loading="lazy">
      ${ep ? `<span class="ep-badge">${ep} Ep</span>` : ''}
    </div>`;
  }
  const colors = ['135deg,#667eea,#764ba2','135deg,#f093fb,#f5576c','135deg,#4facfe,#00f2fe',
    '135deg,#43e97b,#38f9d7','135deg,#fa709a,#fee140','135deg,#a18cd1,#fbc2eb'];
  const color = colors[Math.abs(title.length) % colors.length];
  return `<div class="${cls}" style="background:linear-gradient(${color});display:flex;flex-direction:column;align-items:center;justify-content:center;color:white;font-size:11px;font-weight:700;text-align:center;padding:8px">
    <div style="font-size:28px;margin-bottom:6px">üé¨</div>
    <div>${title.slice(0,30)}</div>
    ${ep ? `<div style="font-size:10px;opacity:0.8;margin-top:4px">${ep} Ep</div>` : ''}
  </div>`;
}

// ============================================================
// HOME
// ============================================================
async function loadHome() {
  homeLoaded = true;
  
  // Load popular (foryou)
  const data = await apiGet(`foryou/1?lang=${LANG}`);
  const dramas = getDramas(data);
  
  if (dramas.length > 0) {
    // Hero
    const hero = dramas[0];
    document.getElementById('hero-title').textContent = getDramaField(hero, 'bookName', 'name', 'title');
    document.getElementById('hero-ep').textContent = (getDramaField(hero, 'chapterCount', 'episodeCount') || '?') + ' Ep';
    const bookId = getDramaField(hero, 'bookId', 'id');
    document.getElementById('hero-watch-btn').onclick = () => openDetail(hero);

    // Popular list
    const popEl = document.getElementById('popular-list');
    popEl.innerHTML = dramas.slice(0, 10).map(d => {
      const title = getDramaField(d, 'bookName', 'name', 'title');
      const score = getDramaField(d, 'score', 'rating');
      return `<div class="drama-card" onclick='openDetail(${JSON.stringify(d)})'>
        ${makeCoverDiv(d)}
        <div class="drama-card-title">${title}</div>
        ${score ? `<div class="drama-card-star">‚≠ê ${score}</div>` : ''}
      </div>`;
    }).join('');
  } else {
    document.getElementById('popular-list').innerHTML = '<div class="empty"><div class="empty-icon">üì°</div><div class="empty-text">Gagal memuat</div></div>';
  }

  // Load new
  const newData = await apiGet(`new/1?lang=${LANG}`);
  const newDramas = getDramas(newData);
  const newEl = document.getElementById('new-list');
  
  if (newDramas.length > 0) {
    newEl.innerHTML = newDramas.slice(0, 10).map(d => {
      const title = getDramaField(d, 'bookName', 'name', 'title');
      const score = getDramaField(d, 'score', 'rating');
      return `<div class="drama-card" onclick='openDetail(${JSON.stringify(d)})'>
        ${makeCoverDiv(d)}
        <div class="drama-card-title">${title}</div>
        ${score ? `<div class="drama-card-star">‚≠ê ${score}</div>` : ''}
      </div>`;
    }).join('');
  } else {
    newEl.innerHTML = '<div class="empty"><div class="empty-icon">üì∫</div><div class="empty-text">Tidak ada data</div></div>';
  }
}

// ============================================================
// RANK
// ============================================================
async function loadRank() {
  rankLoaded = true;
  const data = await apiGet(`rank/1?lang=${LANG}`);
  const dramas = getDramas(data);
  const el = document.getElementById('rank-list');
  
  if (!dramas.length) {
    el.innerHTML = '<div class="empty"><div class="empty-icon">üèÜ</div><div class="empty-text">Gagal memuat ranking</div></div>';
    return;
  }
  
  el.innerHTML = dramas.slice(0, 20).map((d, i) => {
    const title = getDramaField(d, 'bookName', 'name', 'title');
    const score = getDramaField(d, 'score', 'rating');
    const ep = getDramaField(d, 'chapterCount', 'episodeCount');
    const numClass = i === 0 ? 'gold' : i === 1 ? 'silver' : i === 2 ? 'bronze' : 'normal';
    const cover = getDramaField(d, 'coverUrl', 'cover', 'coverImg');
    
    return `<div class="rank-card" onclick='openDetail(${JSON.stringify(d)})'>
      <div class="rank-num ${numClass}">${i+1}</div>
      ${cover 
        ? `<img class="rank-cover" src="${cover}" onerror="this.style.background='linear-gradient(135deg,#f093fb,#f5576c)'" loading="lazy">`
        : `<div class="rank-cover" style="background:linear-gradient(135deg,#f093fb,#f5576c);display:flex;align-items:center;justify-content:center;font-size:24px">üé¨</div>`
      }
      <div class="rank-info">
        <div class="rank-title">${title}</div>
        <div class="rank-meta">${ep ? ep + ' Episode' : 'Drama China'}</div>
      </div>
      ${score ? `<div class="rank-score">‚≠ê ${score}</div>` : ''}
    </div>`;
  }).join('');
}

// ============================================================
// SEARCH & TRENDING
// ============================================================
async function loadTrending() {
  trendingLoaded = true;
  const data = await apiGet(`rank/1?lang=${LANG}`);
  const dramas = getDramas(data);
  const el = document.getElementById('trending-grid');
  
  if (!dramas.length) {
    el.innerHTML = '<div style="grid-column:span 2;text-align:center;color:var(--text-muted);padding:20px">Gagal memuat</div>';
    return;
  }
  
  el.innerHTML = dramas.slice(0, 6).map((d, i) => {
    const title = getDramaField(d, 'bookName', 'name', 'title');
    const cover = getDramaField(d, 'coverUrl', 'cover', 'coverImg');
    
    return `<div class="grid-card" onclick='openDetail(${JSON.stringify(d)})'>
      <div class="grid-card-img" style="${cover ? '' : 'background:linear-gradient(135deg,#667eea,#764ba2)'}">
        ${cover ? `<img src="${cover}" style="width:100%;height:100%;object-fit:cover;border-radius:14px" loading="lazy">` : `<div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;font-size:36px">üé¨</div>`}
        <div class="grid-rank-badge">#${i+1}</div>
      </div>
      <div class="grid-card-title">${title}</div>
    </div>`;
  }).join('');
}

async function doSearch() {
  const kw = document.getElementById('search-input').value.trim();
  if (!kw) return;
  searchKeyword(kw);
}

async function searchKeyword(kw) {
  document.getElementById('search-input').value = kw;
  document.getElementById('search-tags-section').style.display = 'none';
  document.getElementById('search-results-section').style.display = 'block';
  document.getElementById('search-result-title').textContent = `üîç "${kw}"`;
  document.getElementById('search-results').innerHTML = '<div class="loader"><div class="spinner"></div></div>';
  
  const enc = encodeURIComponent(kw);
  const data = await apiGet(`search/${enc}/1?lang=${LANG}&pageSize=20`);
  const dramas = getDramas(data);
  const el = document.getElementById('search-results');
  
  if (!dramas.length) {
    el.innerHTML = `<div class="empty"><div class="empty-icon">üîç</div><div class="empty-text">Tidak ditemukan</div><div class="empty-sub">Coba kata kunci lain</div></div>`;
    return;
  }
  
  el.innerHTML = dramas.slice(0, 20).map(d => {
    const title = getDramaField(d, 'bookName', 'name', 'title');
    const score = getDramaField(d, 'score', 'rating');
    const ep = getDramaField(d, 'chapterCount', 'episodeCount');
    const cover = getDramaField(d, 'coverUrl', 'cover', 'coverImg');
    
    return `<div class="rank-card" onclick='openDetail(${JSON.stringify(d)})'>
      ${cover 
        ? `<img class="rank-cover" src="${cover}" loading="lazy">`
        : `<div class="rank-cover" style="background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:center;font-size:24px">üé¨</div>`
      }
      <div class="rank-info">
        <div class="rank-title">${title}</div>
        <div class="rank-meta">${ep ? ep + ' Episode' : 'Drama China'}</div>
      </div>
      ${score ? `<div class="rank-score">‚≠ê ${score}</div>` : ''}
    </div>`;
  }).join('');
}

function clearSearch() {
  document.getElementById('search-tags-section').style.display = 'block';
  document.getElementById('search-results-section').style.display = 'none';
  document.getElementById('search-input').value = '';
}

// ============================================================
// DETAIL
// ============================================================
function openDetail(drama) {
  screenHistory.push(currentScreen);
  
  // Update nav active (none for detail)
  ['home','search','rank','profile'].forEach(n => {
    document.getElementById('nav-' + n)?.classList.remove('active');
  });

  const bookId = getDramaField(drama, 'bookId', 'id');
  const title = getDramaField(drama, 'bookName', 'name', 'title');
  const desc = getDramaField(drama, 'introduce', 'description', 'intro', 'synopsis') || 'Tidak ada deskripsi tersedia.';
  const cover = getDramaField(drama, 'coverUrl', 'cover', 'coverImg');
  const score = getDramaField(drama, 'score', 'rating');
  const ep = getDramaField(drama, 'chapterCount', 'episodeCount');
  
  currentBookId = bookId;
  
  document.getElementById('detail-title').textContent = title;
  document.getElementById('detail-desc').textContent = desc;
  document.getElementById('detail-desc').className = 'detail-desc collapsed';
  
  // meta badges
  const metaEl = document.getElementById('detail-meta');
  metaEl.innerHTML = [
    score ? `<span class="detail-badge">‚≠ê ${score}</span>` : '',
    ep ? `<span class="detail-badge">üì∫ ${ep} Episode</span>` : '',
    `<span class="detail-badge">üá®üá≥ Drama China</span>`
  ].filter(Boolean).join('');

  // cover
  if (cover) {
    document.getElementById('detail-cover').src = cover;
    document.getElementById('detail-thumb').src = cover;
  }

  // fav btn
  const isFav = favorites.includes(bookId);
  document.getElementById('detail-fav-btn').textContent = isFav ? '‚ù§Ô∏è' : 'ü§ç';
  
  // watch btn
  document.getElementById('detail-watch-btn').onclick = () => watchEpisode(bookId, 1, title);
  
  // load episodes
  loadChapters(bookId);

  currentScreen = 'detail';
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-detail').classList.add('active');
}

async function loadChapters(bookId) {
  const el = document.getElementById('ep-grid');
  el.innerHTML = '<div class="loader" style="grid-column:span 5"><div class="spinner"></div></div>';
  
  const data = await apiGet(`chapters/${bookId}?lang=${LANG}`);
  allChapters = safeGet(data, 'data', 'chapterList') 
    || safeGet(data, 'data', 'list') 
    || getDramas(data)
    || [];
  
  currentMaxEp = allChapters.length;
  
  if (!allChapters.length) {
    el.innerHTML = `<div style="grid-column:span 5;text-align:center;color:var(--text-muted);padding:20px">
      <div style="font-size:32px;margin-bottom:8px">üì∫</div>
      Daftar episode tidak tersedia
    </div>`;
    return;
  }
  
  el.innerHTML = allChapters.slice(0, 50).map((ch, i) => {
    const epNum = getDramaField(ch, 'chapterNo', 'episodeNo') || (i+1);
    return `<button class="ep-btn" onclick="watchEpisode('${bookId}', ${epNum}, '')">
      ${epNum}
    </button>`;
  }).join('');
}

// ============================================================
// WATCH
// ============================================================
async function watchEpisode(bookId, ep, title) {
  screenHistory.push(currentScreen);
  currentScreen = 'watch';
  currentBookId = bookId;
  currentEp = Number(ep);
  
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById('screen-watch').classList.add('active');
  ['home','search','rank','profile'].forEach(n => {
    document.getElementById('nav-' + n)?.classList.remove('active');
  });
  
  document.getElementById('watch-title').textContent = title || 'Loading...';
  document.getElementById('watch-sub').textContent = `Episode ${ep}`;
  document.getElementById('watch-topbar-title').textContent = `Episode ${ep}`;
  document.getElementById('video-placeholder').textContent = 'Memuat video...';
  document.getElementById('watch-ext-link').style.display = 'none';

  // Save to history
  if (!watchHistory.includes(bookId)) {
    watchHistory.unshift(bookId);
    if (watchHistory.length > 50) watchHistory.pop();
    localStorage.setItem('history', JSON.stringify(watchHistory));
    updateProfileCounts();
  }

  const data = await apiGet(`watch/${bookId}/${ep}?lang=${LANG}&direction=1`);
  const videoUrl = safeGet(data, 'data', 'videoUrl')
    || safeGet(data, 'data', 'url')
    || safeGet(data, 'data', 'playUrl')
    || safeGet(data, 'data', 'streamUrl');
  
  const dramaTitle = safeGet(data, 'data', 'bookName') || safeGet(data, 'data', 'name') || title;
  document.getElementById('watch-title').textContent = dramaTitle || title;

  if (videoUrl) {
    document.getElementById('video-placeholder').textContent = 'Klik tombol di bawah untuk menonton';
    document.getElementById('watch-ext-link').href = videoUrl;
    document.getElementById('watch-ext-link').style.display = 'inline-flex';
  } else {
    document.getElementById('video-placeholder').textContent = '‚ö†Ô∏è Video tidak tersedia. Coba episode lain.';
  }

  // Nav buttons
  document.getElementById('prev-ep-btn').disabled = ep <= 1;
  document.getElementById('prev-ep-btn').style.opacity = ep <= 1 ? '0.4' : '1';
  
  // Build episode grid in watch screen
  if (allChapters.length > 0) {
    const watchEpGrid = document.getElementById('watch-ep-grid');
    watchEpGrid.innerHTML = allChapters.slice(0, 50).map((ch, i) => {
      const epNum = getDramaField(ch, 'chapterNo', 'episodeNo') || (i+1);
      return `<button class="ep-btn ${epNum == ep ? 'active' : ''}" onclick="watchEpisode('${bookId}', ${epNum}, '${dramaTitle || ''}')">
        ${epNum}
      </button>`;
    }).join('');
  }
}

function changeEp(dir) {
  const newEp = currentEp + dir;
  if (newEp < 1) return;
  watchEpisode(currentBookId, newEp, document.getElementById('watch-title').textContent);
}

// ============================================================
// FAVORITES
// ============================================================
function toggleFav() {
  const bookId = currentBookId;
  const btn = document.getElementById('detail-fav-btn');
  
  if (favorites.includes(bookId)) {
    favorites = favorites.filter(f => f !== bookId);
    btn.textContent = 'ü§ç';
    showToast('Dihapus dari favorit');
  } else {
    favorites.unshift(bookId);
    btn.textContent = '‚ù§Ô∏è';
    showToast('Ditambahkan ke favorit ‚ù§Ô∏è');
  }
  localStorage.setItem('favs', JSON.stringify(favorites));
  updateProfileCounts();
}

function toggleDesc() {
  const el = document.getElementById('detail-desc');
  const btn = document.getElementById('read-more-btn');
  if (el.classList.contains('collapsed')) {
    el.classList.remove('collapsed');
    btn.textContent = 'Sembunyikan ‚Äπ';
  } else {
    el.classList.add('collapsed');
    btn.textContent = 'Selengkapnya ‚Ä∫';
  }
}

function updateProfileCounts() {
  document.getElementById('fav-count-label').textContent = favorites.length + ' drama difavoritkan';
  document.getElementById('history-count-label').textContent = watchHistory.length + ' drama ditonton';
}

function loadNewDramas() { switchScreen('search'); }

// ============================================================
// TOAST
// ============================================================
let toastTimer;
function showToast(msg) {
  const el = document.getElementById('toast');
  el.textContent = msg;
  el.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => el.classList.remove('show'), 2500);
}

// ============================================================
// INIT
// ============================================================
updateProfileCounts();
loadHome();
</script>
</body>
</html>
